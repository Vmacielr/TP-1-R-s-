
# TP6 : Des bo services dans des bo LANs

## ☀️ Prouvez que...
 - une machine du LAN1 peut joindre internet (ping un nom de domaine)
 - une machine du LAN2 peut joindre internet (ping nom de domaine)
 - une machine du LAN1 peut joindre une machine du LAN2 (ping une adresse IP)

```Powershell
[root@dhcp network-scripts]# ping 10.6.1.254
PING 10.6.1.254 (10.6.1.254) 56(84) bytes of data.
64 bytes from 10.6.1.254: icmp_seq=1 ttl=64 time=1.64 ms
64 bytes from 10.6.1.254: icmp_seq=2 ttl=64 time=4.70 ms
^C
--- 10.6.1.254 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1003ms
rtt min/avg/max/mdev = 1.638/3.171/4.704/1.533 ms
[root@dhcp network-scripts]# ping ynov.com
PING ynov.com (104.26.10.233) 56(84) bytes of data.
64 bytes from 104.26.10.233 (104.26.10.233): icmp_seq=1 ttl=53 time=21.8 ms
64 bytes from 104.26.10.233 (104.26.10.233): icmp_seq=2 ttl=53 time=22.2 ms
^C
--- ynov.com ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1001ms
rtt min/avg/max/mdev = 21.807/21.980/22.154/0.173 ms
```

```Powershell
[root@dns ~]# ping ynov.com
PING ynov.com (104.26.10.233) 56(84) bytes of data.
64 bytes from 104.26.10.233 (104.26.10.233): icmp_seq=1 ttl=53 time=21.2 ms
64 bytes from 104.26.10.233 (104.26.10.233): icmp_seq=2 ttl=53 time=20.6 ms
^C
--- ynov.com ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1002ms
rtt min/avg/max/mdev = 20.568/20.859/21.151/0.291 ms
```

```Powershell
--- 10.6.1.253 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3007ms
rtt min/avg/max/mdev = 1.911/3.707/5.625/1.320 ms
PING 10.6.2.12 (10.6.2.12) 56(84) bytes of data.
64 bytes from 10.6.2.12: icmp_seq=1 ttl=64 time=3.26 ms
64 bytes from 10.6.2.12: icmp_seq=2 ttl=64 time=1.55 ms
^C
--- 10.6.2.12 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1003ms
rtt min/avg/max/mdev = 1.554/2.406/3.258/0.852 ms
PING 10.6.2.11 (10.6.2.11) 56(84) bytes of data.
64 bytes from 10.6.2.11: icmp_seq=1 ttl=64 time=0.022 ms
64 bytes from 10.6.2.11: icmp_seq=2 ttl=64 time=0.046 ms
^C
--- 10.6.2.11 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1051ms
rtt min/avg/max/mdev = 0.022/0.034/0.046/0.012 ms
```
## II. LAN clients


### 1. Serveur DHCP
#### ➜ Installez et configurez un serveur DHCP sur dhcp.tp6.b1

###  2. Client

#### ☀️ Prouvez que.

- le client a bien récupéré une adresse IP en DHCP

- avec un ip a le mot-clé dynamic doit être écrit sur la ligne qui contient l'adresse IP
(y'a pas ce mot-clé quand tu définis une IP statique)

```Powershell
2: enp0s3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 08:00:27:c9:f7:07 brd ff:ff:ff:ff:ff:ff
    inet 10.6.1.37/24 brd 10.6.1.255 scope global dynamic noprefixroute enp0s3
       valid_lft 3491sec preferred_lft 3491sec
    inet6 fe80::a00:27ff:fec9:f707/64 scope link
       valid_lft forever preferred_lft forever
```
- vous avez bien 1.1.1.1 en DNS

```Powershell
[root@localhost ~]# cat /etc/resolv.conf
# Generated by NetworkManager
nameserver 1.1.1.1
[root@localhost ~]#
```


- vous avez bien la bonne passerelle indiquée

```Powershell
[root@localhost ~]# ip r s
default via 10.6.1.254 dev enp0s3 proto dhcp src 10.6.1.37 metric 100
10.6.1.0/24 dev enp0s3 proto kernel scope link src 10.6.1.37 metric 100
```


- que ça ping un nom de domaine public sans problème magueule

```Powershell
[root@localhost ~]# ping ynov.com
PING ynov.com (172.67.74.226) 56(84) bytes of data.
64 bytes from 172.67.74.226 (172.67.74.226): icmp_seq=1 ttl=52 time=32.6 ms
64 bytes from 172.67.74.226 (172.67.74.226): icmp_seq=2 ttl=52 time=110 ms
^C
--- ynov.com ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1002ms
rtt min/avg/max/mdev = 32.569/71.094/109.619/38.525 ms
```



## III. LAN serveurzzzz

### 1. Serveur Web

#### 3. Analyse et test

##### ☀ Déterminer sur quel port écoute le serveur NGINX

```Powershell
[root@web ~]# sudo ss -lnptu | grep 80
tcp   LISTEN 0      511          0.0.0.0:80        0.0.0.0:*    users:(("nginx",pid=11548,fd=6),("nginx",pid=11547,fd=6))
tcp   LISTEN 0      511             [::]:80           [::]:*    users:(("nginx",pid=11548,fd=7),("nginx",pid=11547,fd=7))
```
#### ☀ Ouvrir ce port dans le firewall

```Powershell
[root@web ~]# sudo firewall-cmd --permanent --add-port=80/tcp
success
[root@web ~]# sudo firewall-cmd --reload
success
```

#### ☀ Visitez le site web !

```Powershell
[root@web ~]# curl http://10.6.2.11
<!doctype html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <title>HTTP Server Test Page powered by: Rocky Linux</title>
    <style type="text/css">
      /*<![CDATA[*/
```

### 2. Serveur DNS

```Powershell

```
